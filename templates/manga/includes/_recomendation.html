<!-- BEGIN: Similar Carousel -->
<div class="relative mb-12 mt-12">
  <!-- Заголовок -->
  <div class="flex items-center pb-6 gap-4">
    <h2 class="text-xl sm:text-2xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">
      Janriga o'xshash tavsiyalar
    </h2>
  </div>

  <!-- Кнопки навигации с пульсацией -->
<!-- Прокачанные кнопки Prev/Next -->
<button
  id="prevBtn"
  aria-label="Previous"
  class="absolute left-3 top-1/2 z-10 -translate-y-1/2 w-10 h-10 rounded-full
         bg-gradient-to-br from-purple-500 to-pink-500
         shadow-xl hover:shadow-2xl
         transform transition
         hover:scale-110 active:scale-95
         "
>
  <svg class="w-5 h-5 text-white mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M15 19l-7-7 7-7" />
  </svg>
</button>

<button
  id="nextBtn"
  aria-label="Next"
  class="absolute right-3 top-1/2 z-10 -translate-y-1/2 w-10 h-10 rounded-full
         bg-gradient-to-br from-purple-500 to-pink-500
         shadow-xl hover:shadow-2xl
         transform transition
         hover:scale-110 active:scale-95
         "
>
  <svg class="w-5 h-5 text-white mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M9 5l7 7-7 7" />
  </svg>
</button>


  <!-- Сама «лента» карточек -->
  <div
    id="slider"
    class="hide-scrollbar flex gap-4 overflow-x-auto px-2 pb-6"
  >
    {% for m in similar_mangas %}
      <div class="card flex-shrink-0 w-40 sm:w-48 md:w-56 transition-transform duration-300 hover:scale-[1.02]">
        <a
          href="{% url 'manga:manga_details' m.slug %}"
          class="block relative bg-gray-900/90 backdrop-blur-sm rounded-xl border border-purple-500/20 hover:border-purple-400/50 shadow-lg shadow-purple-900/10 overflow-hidden group"
          aria-label="{{ m.title }}"
        >
          <div class="relative aspect-[2/3] overflow-hidden">
            <img
              src="{{ m.cover_image.url }}"
              alt="{{ m.title }} cover"
              class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
              loading="lazy"
            />
            <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-3 text-white space-y-1">
              <h3
                class="text-sm font-bold truncate drop-shadow-[0_1px_3px_rgba(0,0,0,0.8)] group-hover:text-purple-400 transition-colors"
              >
                {{ m.title }}
              </h3>
            </div>
          </div>
        </a>
      </div>
    {% empty %}
      <div class="w-full flex-shrink-0 py-8 text-center rounded-xl bg-gray-800/20 border-2 border-dashed border-gray-700">
        <div class="max-w-xs mx-auto">
          <i class="fa-regular fa-face-frown-open text-3xl mb-3 text-gray-500"></i>
          <p class="text-gray-500 font-medium mb-2">O'xshash janrlar topilmadi</p>
        </div>
      </div>
    {% endfor %}
  </div>
</div>
<!-- END: Similar Carousel -->

<!-- Стили для пульсации, скрытия скроллбара и scroll-snap -->
<style>
  /* Пульсация кнопок */
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50%       { opacity: 0.3; }
  }
  .pulse-animation {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  /* Скрыть дефолтный скроллбар */
  #slider::-webkit-scrollbar { display: none; }
  #slider { -ms-overflow-style: none; scrollbar-width: none; }

  /* Scroll snap + плавная прокрутка */
  #slider {
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
  }
  .card { scroll-snap-align: start; }
</style>

<!-- JS для Prev/Next -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const slider = document.getElementById('slider');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');

    const card = slider.querySelector('.card');
    const style = getComputedStyle(card);
    const gap = parseInt(style.marginRight) || 0;
    const step = card.getBoundingClientRect().width + gap;

    prevBtn.addEventListener('click', () => {
      slider.scrollBy({ left: -step, behavior: 'smooth' });
    });
    nextBtn.addEventListener('click', () => {
      slider.scrollBy({ left: step, behavior: 'smooth' });
    });
  });
</script>
